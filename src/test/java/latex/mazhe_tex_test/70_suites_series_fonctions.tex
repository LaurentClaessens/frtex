% This is part of Mes notes de mathématique
% Copyright (c) 2011-2016
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Théorème de la moyenne}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{theorem}[\cite{MonCerveau}]      \label{ThoooEZLGooMChwLT}
    Soit \( Q\) un compact connexe par arcs et une fonction continue \( f\colon Q\to \eR\). Si \( \lambda\) est la mesure de Lebesgue, alors il existe \( a\in Q\) tel que
    \begin{equation}
        f(a)=\frac{1}{ \lambda(Q) }\int_Qfd\lambda
    \end{equation}
\end{theorem}

\begin{proof}
    En posant \( I=\int_Qfd\lambda\) nous avons immédiatement
    \begin{equation}        \label{EqooTYQCooVxdazW}
        \min(f)\lambda(Q)\leq I\leq \max(f)\lambda(Q)
    \end{equation}
    où le minimum et le maximum existent parce que \( f\) est continue sur un compact. Si une des deux inégalités est une égalité alors la fonction est constante. En effet supposons que la première inégalité soit une égalité; si la fonction n'était pas constante, il existerait une boule sur laquelle \( f\) serait strictement supérieure à \( \min(f)\). En intégrant d'abord sur cette boule et ensuite sur le complémentaire nous obtenons une intégrale plus grande que \( \min(f)\lambda(Q)\).

    Soit \( \epsilon>0\). Il existe \( \alpha,\beta\in Q\) tels que \( f(\alpha)\leq\min(f)+\epsilon\) et \( f(\beta)\geq\max(f)-\epsilon\). Soit \( \gamma\colon \mathopen[ 0 , 1 \mathclose]\to Q\) un chemin continu tel que \( \gamma(0)=\alpha\) et \( \gamma(1)=\beta\). La fonction \( f\circ \gamma\colon \mathopen[ 0 , 1 \mathclose]\to \eR\) est alors continue et vérifie \( (f\circ\gamma)(0)\leq \min(f)+\epsilon\) et \( (f\circ\gamma)(1)\geq \max(f)-\epsilon\).

    Si \( \epsilon\) est assez petit et vu que les inégalités \eqref{EqooTYQCooVxdazW} sont strictes,
    \begin{equation}
        \lambda(Q)(f\circ\gamma)(0)\leq \min(f)\lambda(Q)+\epsilon\lambda(Q)<I<\max(f)\lambda(Q)-\epsilon\lambda(Q)\leq\lambda(Q)(f\circ \gamma)(1).
    \end{equation}
    Par le théorème des valeurs intermédiaires \ref{ThoValInter}, il existe \( t_0\in\mathopen[ 0 , 1 \mathclose]\) tel que \( \lambda(Q)(f\circ\gamma)(t_0)=I\). Le point \( a=\gamma(t_0)\) vérifie
    \begin{equation}
        f(a)=\frac{1}{ \lambda(Q) }\int_Qfd\lambda.
    \end{equation}
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Mesure à densité}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Théorème de Radon-Nikodym}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[Produit d'une mesure par une fonction]
    Si \( (S,\tribF,m_1)\) est un espace mesuré, et si \( f\colon S\to \eR\) est intégrable, et si \( B\) est un ensemble mesurable, nous définissons \( fm_1\) par
    \begin{equation}
        m_2(B)=(fm_1)(B)=\int_Bf(t)dm_1(t).
    \end{equation}
    Cela est une mesure positive sur \( (S,\tribF)\).
\end{proposition}

\begin{proof}
    D'abord pour l'ensemble vide : \( m_2(\emptyset)=\int_{\emptyset}fdm_1=0\).

    Si \( A_n\) sont des éléments disjoints de \( \tribF\) tels que \( \bigcup_nA_n\in\tribF\). Alors en utilisant la proposition \ref{PropOPSCooVpzaBt}, nous avons le calcul suivant :
    \begin{equation}
        m_2\big( \bigcup_nA_n \big)=\int_{\bigcup_nA_n}f(t)dm_1(t)=\sum_{n}\int_{A_n}f(t)dm_1(t)=\sum_nm_2(A_n).
    \end{equation}
\end{proof}

\begin{definition}[\cite{PersoFeng}]
    Soient \( \mu\) et \( \nu\) deux mesures sur l'espace mesurable \( (\Omega,\tribA)\). Nous disons que la mesure \( \mu\) est \defe{dominée}{dominée!mesure} par \( \nu\) si pour tout ensemble mesurable \( A\), \( \nu(A)=0\) implique \( \mu(A)=0\).

    Si \( \nu\) est une mesure positive et \( \mu\) une mesure, nous disons que \( \mu\) est \defe{absolument continue}{mesure!absolument continue} par rapport à \( \nu\) si \( \nu(A)=0\) implique \( \mu(A)=0\). On note aussi \( \mu\ll\nu\)\nomenclature[Y]{$\mu\ll\nu$}{La mesure \( \mu\) est absolument continue par rapport à la mesure \( \nu\).}.
\end{definition}

La mesure \( \mu\) est \defe{portée}{portée!mesure} par l'ensemble \( E\in\tribA\) si pour tout \( A\in\tribA\), 
\begin{equation}
    \mu(A)=\mu(A\cap E).
\end{equation}

Nous écrivons que \( \mu\perp\nu\)\nomenclature[Y]{\( \mu\perp\nu\)}{mesures perpendiculaires} si il existe un ensemble \( E\in\tribA\) tel que \( \mu\) soit porté par \( E\) et \( \nu\) soit porté par \( \complement E\).

\begin{theorem}[Radon-Nikodym\cite{NikoLi}]
    Soient \( \mu\) et \( \nu\) deux mesures \( \sigma\)-finies sur un espace métrisable \( (\Omega,\tribA)\).
    \begin{enumerate}
        \item
            Il existe un unique couple de mesures \( \mu_1\) et \( \mu_2\) telles que
            \begin{enumerate}
                \item
                    \( \mu=\mu_1+\mu_2\)
                \item
                    \( \mu_1\) est dominé par \( \nu\)
                \item
                    \( \mu_2\perp \nu\).
            \end{enumerate}
            Dans ce cas, les mesures \( \mu_1\) et \( \mu_2\) sont positives et \( \sigma\)-finies.
        \item
            À égalité \(  \nu\)-presque partout près, il existe une unique fonction mesurable positive \( f\) telle que pour tout mesurable \( A\),
            \begin{equation}
                \mu_1(A)=\int_Ad\mu_1=\int_{\Omega}\mtu_Afd \nu.
            \end{equation}
        \item
            À égalité \( \nu\)-presque partout près, il existe une unique fonction positive mesurable \( h\) telle que \( \mu_1=h\nu\).
    \end{enumerate}
\end{theorem}
\index{théorème!Radon-Nikodym}
%TODO : une preuve

\begin{corollary}   \label{CorZDkhwS}
    Si \( \mu\) es une mesure \( \sigma\)-finie dominée par la mesure \( \sigma\)-finie \( m\), alors \( \mu\) possède une unique fonction de densité.
\end{corollary}

\begin{corollary}       \label{CorDomDens}
    Soient \( \mu\) et \( m\), deux mesures positives \( \sigma\)-finies sur \( (\Omega,\tribA)\). Alors \( m\) domine \( \mu\) si et seulement si \( \mu\) possède une densité par rapport à \( m\).
\end{corollary}
 
\begin{proof}
    Si \( \mu\) est dominée par \( m\), alors la décomposition \( \mu=\mu+0\) satisfait le théorème de Radon-Nikodym. Par conséquent il existe une fonction \( f\) telle que
    \begin{equation}
        \mu(A)=\int_Afdm.
    \end{equation}
    Cette fonction est alors une densité pour \( \mu\) par rapport à \( m\).

    Pour la réciproque, nous supposons que \( \mu\) a une densité \( f\) par rapport à \( m\), et que \( A\) est une ensemble de \( m\)-mesure nulle :
    \begin{equation}
        m(A)=\int_{\Omega}\mtu_Adm=0.
    \end{equation}
    Cela signifie que la fonction \( \mtu_A\) est \( m\)-presque partout nulle. La fonction produit \( \mtu_Af\) est également nulle \( m\)-presque partout, et par conséquent
    \begin{equation}
        \mu(A)=\int_{\Omega}\mtu_Afdm=0.
    \end{equation}
\end{proof}

\begin{probleme}
    Est-ce que la démonstration de cela ne demande pas la convergence monotone d'une façon ou d'une autre ?
\end{probleme}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure complexe}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}[Mesure complexe\cite{TLRRooOjxpTp}] \label{DefGKHLooYjocEt}
    Si \( (\Omega,\tribA)\) est un espace mesurable, une \defe{mesure complexe}{mesure!complexe} est une application \( \mu\colon \tribA\to \eC\) telle que
    \begin{enumerate}
        \item
            $\mu(\emptyset)=0$,
        \item
            \( \nu\) est sous-additive : si les ensembles \( A_i\in\tribA\), alors \( \sum_i\mu(A_i)=\mu(\bigcup_iA_i)\).
    \end{enumerate}
\end{definition}
Notons que la série $\sum_i\mu(A_i)$ est alors nécessairement absolument convergente. En effet changer l'ordre de la somme ne change pas l'union, et donc ne change pas la valeur de la somme. Si \( \sigma\colon \eN\to \eN\) est une permutation, 
\begin{equation}
    \sum_i\mu(A_{\sigma(i)})=\mu\big( \bigcup_iA_{\sigma(i)} \big)=\mu\big( \bigcup_iA_i \big)=\sum_i\mu(A_i).
\end{equation}
Le théorème \ref{PopriXWvIY} dit alors que la somme doit être absolument convergente.


\begin{theorem}[Radon-NikoDym complexe\footnote{L'histoire du nom de ce théorème est intéressante. Lorsque monsieur et madame Rèmederdonnukodym apprirent que leurs amis, les Rèmedelaboulechevelue avaient appelé leur fils Théo, ils décidèrent d'en faire autant. C'est en souvenir de ces circonstances que monsieur Nikodym (prénommé Radon) décida de faire des math.}]\label{ThoZZMGooKhRYaO}
    Soit \( \mu\) une mesure positive sur \( (\Omega,\tribA)\) et \( \nu\) une mesure complexe. Alors
    \begin{enumerate}
        \item
            Il existe un unique couple de mesures complexes \( \nu_a\), \( \nu_s\) sur \( (\Omega,\tribA)\) tel que
            \begin{enumerate}
                \item
                    \( \nu=\nu_a+\nu_s\)
                \item
                    \( \nu_a\ll\mu\)
                \item
                    \( \nu_s\perp \mu\).
            \end{enumerate}
        \item
            Ces mesures satisfont alors \( \nu_a\perp\nu_s\).
        \item
            Il existe une fonction intégrable \( h\colon \Omega\to \eC\) telle que \( \nu_a=h\mu\).
        \item
            La fonction \( h\) est unique à \( \mu\)-équivalence près.
        \item   \label{ItemDIXOooFqOkgGv}
            Si de plus \( \nu\ll \mu\) alors \( \nu=h\mu\).
    \end{enumerate}
\end{theorem}
\index{théorème!Radon-Nikodym!complexe}
\begin{proof}
    No proof.
\end{proof}

\begin{remark}  \label{RemSYRMooZPBhbQ}
    Le point \ref{ItemDIXOooFqOkgGv} est souvent utilisé sous la forme
    \begin{equation}
        \nu(A)=\int_{\Omega}\mtu_A(\omega)h(\omega)d\mu(\omega)=\int_{A}h(\omega)d\mu(\omega).
    \end{equation}
\end{remark}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Théorème d'approximation}
%---------------------------------------------------------------------------------------------------------------------------

\begin{theorem}[Théorème d'approximation\cite{YHRSDGc}]     \label{ThoAFXXcVa}
    Soit \( (X,\tribB,\mu)\) un espace mesuré où \( \tribB\) sont les boréliens de \( X\). Soit \( A\in \tribB\) tel que \( A\subset W\) où \( W\) est un ouvert avec \( \mu(W)<\infty\). Soit aussi \( \epsilon>0\).
    \begin{enumerate}
        \item
            Il existe un fermé \( F\) et un ouvert \( V\) tels que \( \mu(V)<\infty\) et
            \begin{equation}
                F\subset A\subset V
            \end{equation}
            et \( \mu(V\setminus F)<\epsilon\).
        \item
            Il existe \( f\in C^0(X,\eR)\) nulle hors de \( W\) vérifiant \( 0\leq f\leq 1\) et
            \begin{equation}
                \int_X| \mtu_A-f |^pd\mu(x)<\epsilon.
            \end{equation}
    \end{enumerate}
\end{theorem}
% TODO : la preuve est dans la référence. Il faut replacer ce théorème après la définition de l'intégrale.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure à densité}
%---------------------------------------------------------------------------------------------------------------------------

Si \( \mu\) est une mesure sur \( \eR^d\), une fonction \( f\colon \eR^d\to \eR\) est une \defe{densité}{densité d'une mesure} si pour tout \( A\subset\eR^d\) nous avons
\begin{equation}
    \mu(A)=\int_Af(x)dx
\end{equation}
où \( dx\) est la mesure de Lebesgue.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Constructions plus naïves de la mesure et de l'intégrale dans le cas réel}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Les sections \ref{SecSLOooeMaig} et \ref{SecZTFooXlkwk} ont donné une construction très complète de la mesure de Lebesgue, et nous avons définit la théorie de l'intégration sur un espace mesuré quelconque dans la définition \ref{DefTVOooleEst}.

Dans cette section nous allons donner différentes choses plus rapides qui servent souvent de définition dans les cours moins avancés.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure de Lebesgue, version rapide}
%---------------------------------------------------------------------------------------------------------------------------

Nous construisons à présent la mesure de Lebesgue sur \( \eR^n\). Un \defe{pavé}{pavé} dans \( \eR^n\) est un ensemble de la forme 
\begin{equation}
    B=\prod_{i=1}^n\mathopen[ a_i , b_i \mathclose];
\end{equation}
le volume d'un tel pavé est défini par \( \Vol(B)=\prod_i(b_i-a_i)\). Soit maintenant \( A\subset \eR^n\). La \defe{mesure externe}{mesure!externe} de \( A\) est le nombre
\begin{equation}
    m^*(A)=\inf\{ \sum_{B\in\mF}\Vol(B)\text{ où \( \mF\) est un ensemble dénombrable de pavés dont l'union recouvre \( A\).} \}
\end{equation}

\begin{definition}  \label{DefKTzOlyH}
Nous disons que \( A\) est \defe{mesurable}{mesurable!Lebesgue} au sens de Lebesgue si pour tout ensemble \( S\subset \eR^n\) nous avons l'égalité
\begin{equation}
    m^*(S)=m^*(A\cap S)+m^*(S\setminus A).
\end{equation}
Dans ce cas nous disons que la mesure de Lebesgue de \( A\) est \( m(A)=m^*(A)\).
\end{definition}

\begin{proposition}     \label{PropNCMToWI}
    Deux fonctions continue égales presque partout pour la mesure de Lebesgue\footnote{Définition \ref{DefKTzOlyH}.} sont égales.
\end{proposition}

\begin{proof}
    Soient \( f\) et \( g\) deux fonctions continues telles que \( f(x)=g(x)\) pour presque tout \( x\in D\). La fonction \( h=f-g\) est alors presque partout nulle et nous devons prouver qu'elle est nulle sur tout \( D\). La fonction \( h\) est continue; si \( h(a)\neq 0\) pour un certain \( a\in D\) alors \( h\) est non nulle sur un ouvert autour de \( a\) par continuité et donc est non nulle sur un ensemble de mesure non nulle.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Pavés et subdivisions}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}
 Nous appelons \defe{pavé}{pavé} de $\eR^p$ toute partie de $\eR^p$ obtenue comme produit de $p$ intervalles de $\eR$. Plus explicitement, une partie $R$ est un pavé de $\eR^p$ si il s'écrit sous la forme
\[
R=\left\{(x_1,\ldots, x_p)\in\eR^p \,\big\vert\,x_i\in \mathcal{I}_i,  i=1,\ldots, p  \right\},
\]
où $\mathcal{I}_i$ est un intervalle de $\eR$ pour tout $i=1,\ldots, p$. 
\end{definition}
On appelle pavé fermé de $\eR^p$ le produit de $p$ intervalles fermés 
\[
R=\prod_{i=1}^{p}[a_i,b_i].
\]
On définit de même le pavé ouvert 
\[
S=\prod_{i=1}^{p}]a_i,b_i[.
\]
Un pavé $ R=\prod_{i=1}^{p}\mathcal{I}_i$ est dit borné si tous les intervalles $\mathcal{I}_i$ sont bornés dans $\eR$. Les pavés non bornés sont des produits d'intervalles où un (ou plusieurs) des intervalles n'est pas borné. Par exemple,
\[
N=]-\infty, 5]\times [0,13].
\]
L'espace $\eR^p$, lui-même, est un pavé de $\eR^p$. 
\begin{definition}
  Une partie $A$ de $\eR^p$ est dite  \defe{pavable}{pavable} s'il existe une famille finie de pavés bornés $R_j$, $j=1,\ldots, n$, et deux à deux disjoints tels que 
\[
A=\cup_{j=1}^{n}R_j.
\] 
\end{definition}
Un exemple de ensemble pavable dans $\eR^2$ est donné à la figure \ref{LabelFigPolirettangolo}. Il existe beaucoup d'ensembles dans $\eR^2$ qui ne sont pas pavables, par exemple les ellipses.
\newcommand{\CaptionFigPolirettangolo}{Un ensemble pavable.}
\input{Fig_Polirettangolo.pstricks}

Le complémentaire d'un pavé est  un ensemble pavable et, en particulier, tout complémentaire d'un pavé borné est une réunion de  pavés non bornés. Toute union finie et toute intersection d'ensemble pavables est pavable.    
\begin{definition}
	Soit $R$ un pavé borné de $\eR^p$, pour fixer les idées on peut penser $R=\prod_{i=1}^{p}[a_i,b_i]$. On appelle \defe{longueur}{longueur!d'une arrête} de l'$i$-ème arrête de $R$ le nombre $b_i-a_i$. La \defe{mesure $p$-dimensionnelle de $R$}{}, $m(R)$, est le produit des longueurs 
\[
m(R)=\prod_{i=1}^{p}(b_i-a_i).
\] 
\end{definition}
\begin{example}
  Dans $\eR^3$, l'ensemble $R=[-1,1]\times[3,4]\times[0,2]$ est un pavé fermé de mesure 
\[
m(R)= (1+1)\cdot(4-3)\cdot(2-0)=4.
\] 
Il s'agit du volume usuel du parallélépipède rectangle.
\end{example}

\begin{example}
 L'ensemble $R=\mathopen] -1 , 1 \mathclose[\times[3,4]\times[0,2]$ est un pavé de $\eR^3$. Il n'est ni fermé ni ouvert, sa mesure est encore $4$.  
\end{example}

Si $R$ est un pavé non borné on peut encore définir sa mesure. La notion de mesure se généralise en deux étapes. D'abord on dit que la longueur d'une arête non bornée est $\infty$. Ensuite, on adopte la convention $0\cdot \infty=0$. Il faut remarquer que avec cette généralisation tout point et toute droite dans $\eR^2$ ont mesure nulle.  

Afin de définir les intégrales, nous allons intensivement faire appel à la notion de subdivision d'intervalles, voir définition \ref{DefSubdivisionIntervalle} et la discussion qui suit.

Lorsqu'on considère un pavé borné $R=\prod_{i=1}^p\mI_i$ de $\eR^p$, on note $\sdS_i$ l'ensemble des subdivisions de l'intervalle $\mI_i$. La notion de subdivision de généralise au cas des pavés.
\begin{definition}
	Soir $R$ un pavé fermé borné de $\eR^p$, pour fixer les idées on peut penser à $R=\prod_{i=1}^p\mathopen[ a_i , b_i \mathclose]$. On appelle \defe{subdivision}{subdivision} finie de $R$ les éléments de l'ensemble $\mathcal{S}=\prod_{i=1}^{p}\mathcal{S}_i$, 
\[
\mathcal{S}=\left\{ (Y_{1},\ldots, Y_{p})\,\big\vert\, Y_{i}=(y_{i,j})_{j=1}^{n_i}\in\mathcal{S}_i,\, i=1,\ldots,p\right\}.
\]
On peut définir de même l'ensemble des subdivisions d'un pavé non borné. 
 \end{definition}
 Souvent, une subdivision d'un pavé $R=\prod_{i=1}^p\mI_i$ sera noté $\sigma=(y_{i,j})_{j=1}^{n_i}$. Dans cette notation, on sous-entend que pour chaque $i$ fixé, les nombres $y_{i,j}$ (il y en a $n_i$) forment une subdivision de l'intervalle $\mI_i$. Afin de vous familiariser avec ces notations, repérez bien tous les éléments de la figure \ref{LabelFigUneCellule}.
\newcommand{\CaptionFigUneCellule}{Une cellule d'une subdivision d'un pavé de $\eR^2$. La cellule grisée est $R_{(4,2)}$.}
\input{Fig_UneCellule.pstricks}

%On désigne par
%\[
%\delta(Y_i)=\max_{0\leq j\leq n}| y_{i,j}- y_{i,j-1}|,
%\] 
%le pas de la subdivision $Y_i$ dans $\mathcal{S}_i$ et par 
%\[
%\delta(\sigma)=\max_{0\leq i\leq p}\delta(Y_i),
%\]  
%le pas de la subdivision $\sigma$ dans $\mathcal{S}$.

\begin{definition}
	Si $\sigma$ est une subdivision d'un pavé $R$, un \defe{raffinement}{raffinement!subdivision d'un pavé} de $\sigma$ est une subdivision de $R$ obtenue en fixant plus de points dans chaque intervalle.
\end{definition}

La subdivision $\sigma$ de $R$ détermine $n_1n_2\ldots n_p$ pavés fermés de la forme 
\[
R_{(k_1,\ldots,k_p)}=\{(x_1,\ldots, x_p)\in\eR^p\,\big\vert\, y_{i,k_{i-1}}\leq x_i\leq y_{i,k_i}\},
\]
où $k_i$ est dans $\{1,\ldots, n_i\}$ et $i$ dans $\{1,\ldots, p\}$. On les appelles \defe{cellules}{cellule d'un pavage} de $\sigma$. On remarque que les cellules de $\sigma$ sont toujours deux à deux disjointes (sauf au plus sur leurs bords). 
\begin{lemma}\label{meas_sous}
	Soit $R$ un pavé borné de $\eR^p$ et soit $\sigma=(y_{i,j})_{j=1}^{n_i}$ une subdivision de $R$. 
On a 
\[
m(R)=\sum_{(k_1,\ldots,k_p)\in K} m(R_{(k_1,\ldots,k_p)}),
\] 
où $K=\{1,\ldots,n_1\}\times\{1,\ldots,n_2\}\times\ldots \times\{1,\ldots,n_p\}$.
\end{lemma}
Le lemme \ref{meas_sous} suggère de définir la mesure d'un ensemble borné pavable $P=\cup_{j=1}^{n}R_j$ comme la somme des mesures des pavés disjoints $R_j$, $j=1,\ldots, n$.
\begin{definition}
Une application $f:\eR^p\to\eR$ est dite \defe{application en escalier}{application!en escalier} sur $\eR^m$ si
  \begin{itemize}
  \item $f$ est une application bornée,
\item il existe une subdivision $\sigma$ de $\eR^p$ telle que la restriction de $f$  est une application constante sur toute cellule $R_k$ de $\sigma$
\[
f_{\vert_{R_k}}=C_k, \qquad C_k\in\eR,
\]
%Pour tout $k=(k_1,\ldots,k_p)$ dans $ K=\{1,\ldots,n_1\}\times\{1,\ldots,n_2\}\times\ldots \times\{1,\ldots,n_p\}$.
 
Une telle subdivision $\sigma$ est dite \defe{associée}{associée!subdivision}\index{subdivision!associée à une fonction} à $f$. 
  \end{itemize}
\end{definition} 
\begin{example}
  La fonction $f$ de $\eR^2$ dans  $\eR$ définie par 
  \begin{equation}
    f(x,y)=\left\{
    \begin{array}{ll}
      1&\qquad \textrm{si } (x,y) \in [0,3]\times[-1,2],\\
2 &\textrm{sinon.} 
    \end{array}\right.
  \end{equation}
est une application en escalier. Exercice : donner une subdivision de $\eR^2$ associée à cette fonction.
\end{example}
\begin{example}
  La fonction $f$ de $\eR^2$ dans  $\eR$ définie par 
  \begin{equation}
    f(x,y)=\left\{
    \begin{array}{ll}
      \frac{1}{m^2+n^2},&\qquad \textrm{si } (x,y) \in [m,m+1]\times[n,n+1], \quad m,\,n\in\eN_0,\\
0, &\textrm{sinon} 
    \end{array}\right.
  \end{equation}
est une application en escalier.  Observez que, dans ce cas, il n'existe pas une subdivision finie de $\eR^2$ associée à $f$. 
\end{example}
\begin{remark}
 Si la subdivision $\sigma$ est associée à $f$ alors tout raffinement de $\sigma$ (c'est à dire, toute subdivision obtenue en fixant plus de points dans chaque intervalle) a la même propriété. 

Si $f$ et $g$ sont deux application en escalier sur $R$ et $\sigma_f$ et $\sigma_g$ sont des subdivisions de $R$ associées respectivement à $f$ et $g$, alors on peut construire une troisième subdivision de $R$ qui est associée à $f$ et à $g$ en même temps. Soient $\sigma_f=(Y_{1},\ldots, Y_{p})$ et $\sigma_g=(Z_{1},\ldots, Z_{p})$, où  $Y_{i}=(y_{i,j})_{j=1}^{m_i}$ et $Z_{i}=(z_{i,j})_{j=1}^{n_i}$ sont des subdivision de l'intervalle $[a_i, b_i]$, pour $i=1,\ldots, p$. La subdivision de $[a_i, b_i]$ obtenue par l'union de $Y_i$ et $Z_i$ est encore une subdivision finie, qu'on appellera $\bar Y_i$. La subdivision $\bar \sigma = (\bar Y_{1},\ldots,\bar Y_{p})$ de $R$ est un raffinement de $\sigma_f $ et de $\sigma_g$, donc elle est associée à la fois à $f$ et à $g$. 

Cela nous permet de prouver que si $f$ et $g$ sont des application en escalier, alors $f+g$, $fg$, $\min\{f,g\}$, $\max\{f,g\}$ et $|f|$ sont des applications en escalier. 
\end{remark}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Intégrale d'une fonction en escalier}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}
  Soit $f$ une fonction de $\eR^m$ dans $\eR^n$. Le \defe{support}{support} de $f$ est la fermeture de l'ensemble des points $x$ tels que $f(x)\neq 0$. 
\end{definition}
\begin{definition}
Une application en escalier $f$ est dite \defe{intégrable}{fonction!en escalier intégrable} si son support est compact. 
\end{definition} 
Soit $f$ une application en escalier sur $\eR^p$. Soit $\sigma$ une subdivision de  $\eR^p$ associée à $f$ et appelons $R_k$ les cellules de $\sigma$, avec $k=(k_1,\ldots,k_p)$ dans $ K=\{1,\ldots,n_1\}\times\{1,\ldots,n_2\}\times\ldots \times\{1,\ldots,n_p\}$. Alors  
\[
f_{\vert_{R_k}}=C_k, \qquad C_k\in\eR.
\]

\begin{definition} 
On définit l'\defe{intégrale}{intégrale!fonction en escalier} de $f$ sur $\eR^p$ par
\[
\int_{\eR^p}f\,dV=\sum_{k\in K}C_km(R_k).
\] 
\end{definition}
L'intégrale ainsi définie est un nombre réel. La proposition suivante nous dit que l'intégrale est «bien définie», au sens que sa valeur ne dépend pas de la subdivision associée à $f$ qu'on utilise dans le calcul. 
\begin{proposition}
Soit $f$ une application en escalier intégrable sur $\eR^p$. Soient $\sigma_1$ et $\sigma_2$ deux subdivisions de $\eR^p$ associées à  $f$. L'intégrale de $f$ ne dépend pas de la subdivision choisie.
\end{proposition}
On ne donne pas une preuve complète de cette proposition. En fait elle est une conséquence de la formule de réduction introduite dans la suite de ce chapitre.  


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Intégrales partielles}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Soit $f$ de $\eR^p$ dans $\eR$ une fonction continue, nulle hors du pavé borné $R$. Posons  $R=\prod_{i=1}^{p}[a_i,b_i]$, pour fixer les idées. Pour chaque $i$ dans $\{1,\ldots, p\}$ fixé, on peut associer à $f$ la fonction $F_i$ de $p-1$ variables définie par
\[
F_i(x_1,\ldots, x_{i-1}, x_{i+1}, \ldots, x_p)=\int_{a_i}^{b_i}f(x_1,\ldots, x_{i-1},y, x_{i+1}, \ldots, x_p)\, dy.
\]  
La fonction $F_i$ est l'intégrale partielle de $f$ par rapport à la $i$-ème variable. 
En particulier, si $f(x_1,\ldots, x_p)=g(x_i)h(x_1,\ldots, x_{i-1}, x_{i+1}, \ldots, x_p)$ on obtient 
\[
F_i=\int_{a_i}^{b_i}g(y)h(x_1,\ldots, x_{i-1}, x_{i+1}, \ldots, x_p)\, dy= h\cdot\int_{a_i}^{b_i}g \, dy.
\]  
La fonction d'une seule variable qu'on obtient à partir de $f$ en fixant $x_1,\ldots, x_{i-1}, x_{i+1}, \ldots, x_p$ et qui associe à $x_i$ la valeur $f(x_1,\ldots, x_{i-1}, x_i, x_{i+1}, \ldots, x_p)$, est appelée $x_i$-ème section de $f$ en $x_1,\ldots, x_{i-1}, x_{i+1}, \ldots, x_p$. 
\begin{example}
  Soit $f$ la fonction de $\eR^2$ dans $\eR$ définie par 
  \begin{equation}
	  f(x,y)=\begin{cases}
		  x+3y	&	\text{si $(x,y)\in\mathopen[ 9 , 10 \mathclose]\times\mathopen] \pi , 5 \mathclose]$}\\
		  0	&	 \text{sinon}.
	  \end{cases}
  \end{equation}
 Les intégrales partielles de $f$ sont 
\[
F_1(y)=\int_{9}^{10}x+3y\,dx=\left[\frac{x^2}{2}+3xy\right]_{x=9}^{x=10}=\frac{19}{2}+3y,
\]
\[
F_2(x)=\int_{\pi}^{5}x+3y\,dy=\left[xy+\frac{3y^2}{2}\right]_{y=\pi}^{y=5}=x(5-\pi)+\frac{3}{2}(25-\pi^2).
\]
\end{example}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Réduction d'une intégrale multiple}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
Soit $R=[a,b]\times[c,d]$ un pavé fermé et borné de $\eR^2$ et soit $f$ une application en escalier intégrable sur $\eR^2$ telle que le support de $f$ soit contenu dans $R$. On considère la subdivision $\sigma$ de $R$ définie par les subdivisions 
\[
a=x_0\leq x_1\leq\ldots\leq x_m=b,
\]  
 \[
c=y_0\leq y_1\leq\ldots\leq y_n=d.
\]  
Les cellules de $\sigma$ sont 
\[
R_{i,j}=[x_{i},x_{i+1}]\times[y_{j},y_{j+1}], \quad\qquad i=0,\ldots,m-1, \quad j=0,\ldots,n-1.
\]
La mesure de $R$ est la somme des mesures des $R_{i,j}$
\begin{equation}
  \begin{aligned}
    m(R)=&\sum_{(i,j)\in \{0,\ldots, m-1\}\times\{0,\ldots, n-1\}} m(R_{i,j})=\\
&=\sum_{j=0}^{n-1}\sum_{i=0}^{m-1}(x_{i+1}-x_{i})\cdot(y_{i+1}-y_{i})=\\
&=\sum_{i=0}^{m-1}(x_{i+1}-x_{i})\cdot\sum_{j=0}^{n-1}(y_{i+1}-y_{i})=\\
&= (b-a)\cdot(d-c).
  \end{aligned}
\end{equation}
Si $f$ est constante sur chaque cellule de $\sigma$ on peut écrire $f$ de la forme suivante
\[
f(x,y)=\sum_{j=0}^{n-1}\sum_{i=0}^{m-1}C_{i,j}\,\chi_{R_{i,j}}
\]
où les $C_{i,j}$ sont des constantes réelles et $\chi_{R_{i,j}}$ est la \defe{fonction caractéristique}{fonction!caractéristique} de $R_{i,j}$
\begin{equation}
  \chi_{R_{i,j}}(x,y)=\left\{
      \begin{array}{ll}
      1,\qquad &\textrm{si } (x,y)\in R_{i,j} ,\\
0, & \textrm{sinon}.
      \end{array}\right.
\end{equation}
Comme $(x,y)$ est dans $R_{i,j}$ si et seulement si $x\in[x_{i},x_{i+1}]$ et $ y\in[y_{j},y_{j+1}]$, on vérifie que la fonction $\chi_{R_{i,j}}$ est égal au produit des fonctions caractéristiques des intervalles $[x_{i},x_{i+1}]$ et $[y_{j},y_{j+1}]$ 
\[
 \chi_{R_{i,j}}(x,y)=\chi_{[x_{i},x_{i+1}]}(x)\cdot\chi_{[y_{j},y_{j+1}]}(y).
\] 
On peut donc écrire la fonction $f$ de la façon suivante
\[
f(x,y)=\sum_{j=0}^{n-1}\sum_{i=0}^{m-1}C_{i,j}\,\chi_{[x_{i},x_{i+1}]}(x)\cdot\chi_{[y_{j},y_{j+1}]}(y).
\] 
Comme on suppose que le support de $f$ est une partie de $R$, l'intégrale de $f$ sur $\eR^2$ est
\begin{equation}
  \begin{aligned}
\int_{\eR^2}f \,dV = \sum_{j=0}^{n-1}\sum_{i=0}^{m-1}C_{i,j}\,m(R_{i,j})=\sum_{j=0}^{n-1}\sum_{i=0}^{m-1}C_{i,j}\,(x_{i+1}-x_i)\cdot(y_{j+1}-y_j).
 \end{aligned}
\end{equation} 
Cette intégrale peut être réduite à la composition de deux intégrales partielles. Il suffit de remarquer que la valeur de l'intégrale de la fonction caractéristique d'un intervalle est la longueur de l'intervalle, 
\begin{equation}
  \begin{aligned}
    C_{i,j}(x_{i+1}-x_i)&\cdot(y_{j+1}-y_j)=\\
&=C_{i,j}\left(\int_{x_i}^{x_{i+1}}\chi_{[x_{i},x_{i+1}]}(x)\, dx \right)\cdot \left(\int_{y_j}^{y_{j+1}}\chi_{[y_{ j},y_{ j+1}]}(y)\, dy \right)=\\
&=C_{i,j}\left(\int_{a}^{b}\chi_{[x_{i},x_{i+1}]}(x)\, dx \right)\cdot \left(\int_{c}^{d}\chi_{[y_{ j},y_{ j+1}]}(y)\, dy \right),
  \end{aligned}
\end{equation}
et utiliser les propriétés de linéarité de l'intégrale
\begin{equation}
  \begin{aligned}
   \int_{\eR^2}f \,dV =& \sum_{j=0}^{n-1}\sum_{i=0}^{m-1}C_{i,j}\,\left(\int_{a}^{b}\chi_{[x_{i},x_{i+1}]}(x)\, dx \right)\cdot \left(\int_{c}^{d}\chi_{[y_{ j},y_{ j+1}]}(y)\, dy \right)=\\
&=\int_{c}^{d}\int_{a}^{b}\sum_{j=0}^{n-1}\sum_{i=0}^{m-1}C_{i,j}\,\chi_{[x_{i},x_{i+1}]}(x)\cdot \chi_{[y_{ j},y_{ j+1}]}(y)\, dx dy=\\
&=\int_{c}^{d}\int_{a}^{b} f\, dx dy.  
  \end{aligned}
\end{equation}
De même on obtient
\begin{equation}
  \begin{aligned}
   \int_{\eR^2}f \,dV =&\int_{a}^{b}\int_{c}^{d}\sum_{j=0}^{n-1}\sum_{i=0}^{m-1}C_{i,j}\,\chi_{[x_{i},x_{i+1}]}(x)\cdot \chi_{[y_{ j},y_{ j+1}]}(y)\, dx dy=\\
&=\int_{a}^{b}\int_{c}^{d} f\, dx dy.  
  \end{aligned}
\end{equation}
En général, on preuve la proposition suivante
\begin{proposition}
 Soit $f$ une application en escalier intégrable sur $\eR^p$ et soit $R$ un pavé borné dans $\eR^p$ qui contient le support de $f$. Comme d'habitude, pour fixer les idées nous écrivons $=\prod_{i=1}^p[a_i,b_i]$. Alors
 \begin{equation}
   \begin{aligned}
     \int_{\eR^p}f(x_1,\ldots, x_p) \, dV =& \int_{a_p}^{b_p}\int_{a_{p-1}}^{b_{p-1}}\cdots\int_{a_1}^{b_1} f(x_1,\ldots, x_p) \, dx_1\cdots dx_p=\\
&=\int_{a_{s_p}}^{b_{s_p}}\int_{a_{s_{p-1}}}^{b_{s_{p-1}}}\cdots\int_{a_{s_1}}^{b_{s_1}} f(x_1,\ldots, x_p) \, dx_1\cdots dx_p,
   \end{aligned}
 \end{equation}
pour toute permutation $(s_1,\ldots,s_p)$ de l'ensemble $\{1,\ldots p\}$.
\end{proposition}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Propriétés de l'intégrale}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Soient $f$ et $g$ deux fonctions en escalier intégrables de $\eR^p$ dans $\eR$, et soient $a$ et $b$ dans $\eR$. 
\begin{description}
\item[Linéarité de l'intégrale] : 
  \begin{itemize}
  \item Additivité : $f+g$ est intégrable et 
\[
\int_{\eR^p} (f+g)\, dV = \int_{\eR^p} f\, dV+ \int_{\eR^p} g\, dV,
\]
\item Homogénéité : $\lambda f$ est intégrable pour tout réel $\lambda$ 
\[
\int_{\eR^p} \lambda  f\, dV = \lambda\int_{\eR^p} f\, dV,
\]
  \end{itemize}
\item[Monotonie] Si $f\leq g$ alors 
\[
 \int_{\eR^p} f\, dV\leq \int_{\eR^p} g\, dV,
\]
\item[Inégalité fondamentale]
  \[
\lvert \int_{\eR^p}f\,dV\rvert \leq\int_{\eR^p}\lvert f\rvert\,dV.
\] 
Cette dernière inégalité s'obtient de la façon suivante :
\[
\lvert\int_{\eR^p}f\,dV\rvert =\lvert \sum_{k\in K} C_k m(R_k)\rvert \leq\sum_{k\in K}\lvert C_k\rvert m(R_k)=\int_{\eR^p}|f|\,dV.
\] 
\item[Inégalité de Čebičeff]  Si $f$ est une application en escalier alors pour tout $a>0$ dans $\eR$ l'ensemble $\{x\in\eR^p\,:\, |f(x)|\geq a\}$ est pavable et borné, et l'inégalité suivante est satisfaite
\[
m\left(\{x\in\eR^p\,:\, |f(x)|\geq a\}\right)\leq \frac{1}{a} \int_{\eR^p}\lvert f\rvert\,dV.
\]
\end{description}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Intégrales multiples, cas général}
%---------------------------------------------------------------------------------------------------------------------------

Nous voulons généraliser la définition d'intégrale multiple au cas des domaines non pavables et de fonctions qui ne sont pas en escalier. Il y a plusieurs méthodes de le faire et ici on ne considère qu'une seule, introduite par Riemann.  
\begin{definition} Soit $f: \eR^p\to \eR$ une fonction.
  \begin{itemize}
	  \item Pour toute application en escalier intégrable $f_*$ telle que $f_*\leq f$, l'intégrale de $f_*$ est dit une \defe{somme inférieure}{somme!inférieure} de $f$. 
	  \item Pour toute application en escalier intégrable $f^*$ telle que $f_*\geq f$, l'intégrale de $f^*$ est dit une \defe{somme supérieure}{somme!supérieure} de $f$. 
  \end{itemize}
\end{definition}
Soient $\sum_* f$ et  $\sum^* f$ les ensembles des sommes inférieures et supérieures de $f$. Grâce à la propriété de  monotonie de l'intégrale on sait que si $a$ est dans $\sum_* f$ et  $b$ est dans $\sum^* f$ alors $a\leq b$. 
\begin{definition}
  La fonction $f$ est intégrable (au sens de Riemann) si $\sum_* f$ et  $\sum^* f$ ne sont pas vides et 
\[
\inf \Sigma^* f=I =\sup \Sigma_* f.
\] 
Dans ce cas, la valeur $I$ est appelée intégrale de $f$ sur $\eR^p$. 
\end{definition}
\begin{remark}
  Toute fonction intégrable est bornée et à support compact. En effet, si le support de la  fonction n'est pas compact alors soit $\sum_* f$ soit $\sum^* f$ doit être vide ! 
\end{remark}
L'intégrale qu'on vient de définir possède toutes les propriétés de l'intégrale pour les fonctions en escalier. Le produit de deux fonctions intégrables est intégrable. 

Il y a des cas où l'intégrabilité d'une fonction n'est pas évidente. Cependant, dans la plupart des exercices et des exemples de ce cours, nous nous aidons avec le critère suivant 
\begin{proposition}
  Toute fonction continue à support compact est intégrable. 
\end{proposition}
Cette proposition n'est a priori pas étonnante, vu qu'une fonction continue sur un support compact est bornée (théorème de Weierstrass \ref{ThoWeirstrassRn}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Réduction d'une intégrale multiple}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
On n'utilise jamais la définition pour calculer la valeur d'une intégrale multiple. La méthode plus efficace, en pratique, est de réduire l'intégrale à la composition de plusieurs intégrales d'une variable.  
\begin{theorem}[de Fubini]\label{fub}
 Soit $f$ une fonction intégrable de $\eR^2$ dans $\eR$. Si pour tout $x$ dans $\eR$ la section $f(x,\cdot)$ est intégrable par rapport à $y$, alors
\[
\int_{\eR^2}f(x,y)\,dV=\int_{\eR}\left(\int_{\eR}f(x,y)\,dx\right)\,dy.
\]
De même, si pour tout $y$ dans $\eR$ la section $f(\cdot, y)$ est intégrable par rapport à $x$, alors
\[
\int_{\eR^2}f(x,y)\,dV=\int_{\eR}\left(\int_{\eR}f(x,y)\,dy\right)\,dx.
\] 
\end{theorem}		\label{ThoSectionINte}
En général, on ne peut pas dire que les sections d'une fonction intégrable sont intégrables, donc il faut vraiment se souvenir des hypothèses du théorème \ref{fub}. En dimension plus haute, on a le même résultat
\begin{theorem}
 Soit $f$ une fonction intégrable de $\eR^p$ dans $\eR$. Si pour tout $(p-1)$-uple $(x_1,\ldots, x_{i-1},x_{i+1}, \ldots, x_p)$ dans $\eR^{p-1}$ la section $f(x_1,\ldots, x_{i-1},\cdot,x_{i+1}, \ldots, x_p)$ est intégrable par rapport à $x_i$, alors
\[
\int_{\eR^p}f \,dV=\int_{\eR}\left(\int_{\eR^{p-1}}f \,dV\right)\,dx_i.
\]
\end{theorem}

 Si $f$ est une fonction positive et intégrable de $\eR^2$ dans $\eR$ on peut interpréter l'intégrale de $f$ comme le volume du solide au-dessous du graphe de $f$.  Avec cette interprétation,  l'intégrale partielle par rapport à $x$ pour $y=y_0$ fixé est l'aire de la tranche qu'on obtient en coupant le solide par le plan $y=y_0$.

 \begin{example}
   Le premier exemple à faire est celui d'une fonction en escalier intégrable et positive. Soit $f\colon \eR^2\to \eR$ la fonction
\begin{equation}
	f(x,y)=\begin{cases}
		1	&	\text{si $(x,y)\in R_1=\mathopen] -1 , 3 \mathclose]\times\mathopen[ 4 , 5 \mathclose]$}\\
		3	&	 \text{si $(x,y)\in R_2=\mathopen] 13 , 15 \mathclose[\times\mathopen[ 0 , 2 \mathclose[$}\\
		0	&	 \text{dans les autres cas.}
	\end{cases}
\end{equation}
L'intégrale de $f$ sur $\eR^2$ est $1\cdot m(R_1)+ 3\cdot m(R_2)= 16$. On voit tout de suite qu'il s'agit de la somme du volume des deux parallélépipèdes de hauteurs respectives $1$ et $3$ et bases $R_1$ et $R_2$. 
 \end{example}

\begin{example} 
On veut calculer le volume du solide $S$, borné par le paraboloïde elliptique $x^2+2y^2+z=16$ et le plans $x=2$, $x=0$, $y=2$ $y=0$, $z=0$. On observe que la portion de  paraboloïde elliptique qui nous intéresse est le graphe de la fonction $f(x,y)=16-x^2-2y^2$ pour $(x,y)$ dans $R=[0,2]\times[0,2]$. La fonction $f$ est continue ainsi que ses sections, donc on peut appliquer le théorème \ref{fub} et décomposer l'intégrale double en deux intégrales simples :
\begin{equation}
  \begin{aligned}
   & \int_R 16-x^2-2y^2 \,dV= \int_{0}^2\int_{0}^2f(x,y)\,dx dy= \\
&=\int_0^2 \left[(16-2y^2)x-\frac{x^3}{3}\right]_{x=0}^{x=2}\, dy =\\
& = \left[ \left(32-\frac{8}{3}\right) y -\frac{4y^3}{3}\right]_{x=0}^{x=2}= 64- \frac{16+32}{3}=48.
  \end{aligned}
\end{equation}
Vérifiez, comme exercice, qu'on obtient le même résultat en intégrant d'abord par rapport à $y$ et puis par rapport à $x$.  
\end{example}

\begin{example}
  Dans les hypothèses du théorème \ref{fub}  l'ordre des intégrations partielles ne change pas la valeur de l'intégrale. En fait, si les calculs sont faites par des êtres humains l'ordre d'intégration peut faire une certaine différence comme dans cet exemple. On veut évaluer la valeur de l'intégrale 
\[
\int_{\eR^2}f(x,y)\, dV
\]
où 
\begin{equation}
	f(x,y)=\begin{cases}
		y\sin(x,y)	&	\text{si $(x,y)\in\mathopen[ 1,2 ,  \mathclose]\times\mathopen[ 0 , \pi \mathclose]$,}\\
		0	&	 \text{sinon.}
	\end{cases}
\end{equation}
Les deux section de $f(x,y)=y\sin(xy)$ sont continues. Si on intègre d'abord par rapport à $y$ on obtient 
\[
-\int_1^2\frac{ \pi\cos(\pi x) }{ x }dx+\int_1^2\frac{ \sin(\pi x) }{ x^2 }dx,
\] 
qui n'est pas du tout immédiat, alors que, si on intègre d'abord par rapport à $x$ on obtient 
\[
\int_0^\pi \cos y - \cos(2y)\,dy.
\] 
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Intégrales sur des parties de $\eR^2$ }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

On veut évaluer l'intégrale de la fonction $f(x,y)=\sqrt{1-x^2}$ sur son domaine, la boule unité $B((0,0),1)$. La théorie introduite jusqu'ici n'est pas suffisante pour résoudre  ce problème, parce que $B((0,0),1)$ n'est pas pavable. Les parties bornées de $\eR^p$ sur lesquelles on peut intégrer des fonction sont dites mesurables (au sens de Riemann) parce que, comme on verra dans la suite, la mesure d'une partie de $\eR^p$ est l'intégrale (s'il existe) de sa fonction caractéristique. 

On peut dire que une partie de $\eR^p$  est mesurable si son bord est <<assez régulier>>. Dans $\eR^2$ il est suffisant que le bord de $A$ soit une réunion finie de courbes paramétrées continues. En particulier, on est très souvent dans un des deux cas suivantes
\begin{description}
\item[Régions du premier type] $A$ est borné et contenu entre les graphes de deux fonctions continues de $x$
\[
A=\{(x,y)\in\eR^2 \,:\, a\leq x\leq b, \, g_1(x)\leq y\leq g_2(x)\}, 
\]
avec $g_1$ et $g_2$ continues. 
\item[Régions du deuxième type] $A$ est borné et contenu entre les graphes de deux fonctions continues de $y$
\[
A=\{(x,y)\in\eR^2 \,:\, c\leq y\leq d, \, h_1(y)\leq x\leq h_2(y)\}, 
\]
avec $h_1$ et $h_2$ continues.
\end{description}
%\ref{LabelFigRegioniPrimoeSecondoTipo}
\newcommand{\CaptionFigRegioniPrimoeSecondoTipo}{Régions du premier et du deuxième type}
\input{Fig_RegioniPrimoeSecondoTipo.pstricks}

\begin{example}
 Il y a des régions qui sont des deux types au même temps, comme les boules centrées à l'origine, le triangle de sommets  $(0,0)$, $(0,a)$ et $(b,0)$, ou la région $C$ délimité par les courbes $y=2x$ et $y=x^2$. Cette dernière admets les représentations suivantes
\[
C= \{(x,y)\in\eR^2 \,:\, 0\leq x\leq 1, \, x^2\leq y\leq 2x\},
\] 
et  
\[
C= \{(x,y)\in\eR^2 \,:\, 0\leq y\leq 1, \, y/2\leq x\leq \sqrt{y}\}.
\]  
\end{example}
\begin{definition}
  Soit $f$ une fonction de $\eR^2$ dans $\eR$ dont le support  $A$ est une région du premier ou du deuxième type. On définit la fonction $\bar f$ comme
 \begin{equation}
 \bar f(x,y) = \left\{ \begin{array}{ll}
     f(x,y), \qquad & \textrm{si } (x,y)\in A,\\
  0 , & \textrm{sinon.} 
    \end{array}\right.
  \end{equation}
  La fonction $f$ est dite \defe{intégrable}{intégrable!fonction non en escalier} si $\bar f$ est intégrable, et la valeur de son intégrale est 
\[
\int_A f\, dV=\int_{\eR^2} \bar f\, dV.
\] 
\end{definition}
Une fonction continue définie sur une région du premier ou du deuxième type est toujours intégrable. 

Pour fixer les idées on suppose ici que $A$ est du premier type et contenue dans le pavé borné $R=[a,b]\times [c,d]$. En suivant la définition on obtient
\begin{equation}
  \begin{aligned}
    \int_A f\, dV&=\int_{\eR^2} \bar f\, dV=\\
    &= \int_a^b\int_c^d \bar f\, dy dx=\\
&= \int_a^b\left(\int_c^{g_1(x)} \bar f\, dy+\int_{g_1(x)}^{g_2(x)} \bar f\, dy+\int_{g_2(x)}^d \bar f\, dy\right)\, dx= \\
&= \int_a^b\int_{g_1(x)}^{g_2(x)}  f\, dy dx.
  \end{aligned}
\end{equation}
De même, si $A$ est du deuxième type on obtient 
\begin{equation}
     \int_A f\, dV=\int_c^d\int_{h_1(y)}^{h_2(y)}  f\, dx dy.
\end{equation}
\begin{example}
	On peut maintenant résoudre notre problème de départ, évaluer l'intégrale de la fonction $f(x,y)=\sqrt{1-x^2}$ sur $B((0,0),1)$. Nous choisissons de décrire la boule unité de $\eR^2$ comme une région du premier type : $B((0,0),1)=\{(x,y)\, :\, x\in[-1,1], \, -\sqrt{1-x^2}\leq y\leq \sqrt{1-x^2} \}$. 
	\begin{equation}
		I=\int_{B}\sqrt{1-x^2}\, dV=\int_{-1}^1\int_{-\sqrt{1-x^2}}^{\sqrt{1-x^2}}\sqrt{1-x^2}dydx
	\end{equation}
	La première intégrale à effectuer, par rapport à $y$, est l'intégrale d'une fonction constante. Ne pas oublier que l'on intègre $\sqrt{1-x^2}$ par rapport à $y$; c'est bien une constante et l'intégrale consiste seulement à multiplier par $y$ :
	\begin{equation}
		I=\int_{-1}^1\left[ y\sqrt{1-x^2} \right]_{y=-\sqrt{1-x^2}}^{y=\sqrt{1-x^2}}dx=2\int_{-1}^1(1-x^2)dx.
	\end{equation}
	Cela est à nouveau une intégrale simple à effectuer. Le résultat est
	\begin{equation}
		2\int_{-1}^1(1-x^2)dx=2\left[ x-\frac{ x^3 }{ 3 } \right]_{x=-1}^{x=1}=\frac{ 8 }{ 3 }.
	\end{equation}
\end{example}
\begin{remark}
	Toutes les techniques d'intégration à une variable restent valables. Par exemple, lorsqu'une des intégrales est l'intégrale d'une fonction impaire sur un intervalle symétrique par rapport à zéro, l'intégrale vaut zéro.
\end{remark}

\begin{normaltext}   \label{NORMooDSNXooFhyHkx}
Par le lemme \ref{LemooPJLNooVKrBhN} nous savons que la mesure d'une région bornée de \( \eR^2\) est l'intégrale de sa fonction caractéristique, si elle existe.

La mesure d'une région bornée de $\eR^2$ est dite son \defe{aire}{aire}, et celle d'une région bornée de $\eR^3$ est son \defe{volume}{volume!région bornée dans $\eR^3$}. Voir aussi la remarque \ref{RemLongIntUn}.
\end{normaltext}


\begin{example}\label{exint}
  On veut calculer l'aire de la région de la figure \ref{LabelFigExampleIntegration} définie par 
\[
A=\{(x,y)\in\eR^2\,\vert\, 0\leq x\leq 1, x^3-1\leq y\leq x \}.
\]
On considère l'intégrale 
\[
\int_{\eR^2} \chi_{A}\, dV= \int_0^1\int^{x}_{x^3+1} 1 \, dy\, dx= \int_0^1 -x^3+x+1\, dx= -\frac{1}{4}+\frac{1}{2}+1=\frac{5}{4}.
\]
\end{example}
\newcommand{\CaptionFigExampleIntegration}{La région $A$ de l'exemple \ref{exint}}
\input{Fig_ExampleIntegration.pstricks}

\begin{exercice}

	% C'est moche, mais il faut laisser une ligne vide ici, sinon il n'y a pas de saut de ligne
	% entre le titre «exercice» et le texte.
  Parfois la région sur laquelle on veut intégrer peut être décrite indifféremment en deux façons, mais la fonction à intégrer nous force a choisir un ordre particulier. Vérifiez que la fonction $f(x,y)=\sin(y^2)$ sur la région triangulaire de sommets $(0,0)$, $(0, 2)$, $(2,2)$ doit être intégrée d'abord par rapport à $x$.     
\end{exercice}

Si une région bornée n'est pas de premier ou de deuxième type on peut normalement la découper en morceaux plus faciles à décrire. On utilise alors la propriété suivante. 
\begin{lemma}
  Soit $A$ un sous-ensemble borné de $\eR^2$ et soient $B_1$ et $B_2$ deux parties de $A$ telles que $B_1\cap B_2=\emptyset$ et $B_1\cup B_2= A$. Alors, pour toute fonction $f$ intégrable sur $A$ (et en particulier pour sa fonction caractéristique) on a
\[
\int_{A}f \, dV= \int_{B_1}f \, dV+\int_{B_2}f \, dV.
\] 
\end{lemma}

\begin{example}\label{exint2}
La région $D$ que nous voyons sur la figure \ref{LabelFigExampleIntegrationdeux} est bornée par la parabole $y^2=2x+6$ et la droite $y=x-1$. La région $D$ est une région du deuxième type. Nous pouvons aussi la décrire comme l'union de deux régions du premier type $D_1$ et $D_2$,
\[
D_1=\{(x,y)\,:\, -3\leq x \leq -1,\, -\sqrt{2x+6}\leq y \leq \sqrt{2x+6}\},
\]
 et 
\[
D_2=\{(x,y)\,:\, -3\leq x \leq -1, \, x-1\leq y \leq \sqrt{2x+6}\}.
\]
\newcommand{\CaptionFigExampleIntegrationdeux}{La région $D$ de l'exemple \ref{exint2}}
\input{Fig_ExampleIntegrationdeux.pstricks}
\end{example}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Intégrales sur des parties de $\eR^3$}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Dans ces notes nous n'avons pas l'ambition de traiter d'une façon rigoureuse l'étude des ensemble mesurables de $\eR^3$. Comme dans la section précédente on se limitera à considérer des cas particuliers. 
\begin{definition}\label{primotipo_solida}
	Soit $E$ une région de  $\eR^3$. On dit que $E$ est une \defe{région solide de premier type}{premier type!région solide} si $E$ est contenue entre les graphes de deux fonctions continues de $x$ et $y$.
\[
E=\{(x,y,z)\in\eR^3\, \vert \, (x,y)\in A\subset \eR^2, u_1(x,y)\leq z\leq u_2(x,y) \}. 
\]   
\end{definition}
Le sous-ensemble de $A$  de $\eR^2$ qui apparaît dans la définition \ref{primotipo_solida} est la projection (ou l'ombre) de $E$ sur le plan $x$-$y$. 
\begin{example}\label{cornet}
 La région $E$ donnée par une portion de sphère collée à un cône est une région solide de premier type
\[
E=\{(x,y,z)\in\eR^3\, \vert \, (x,y)\in \bar B((0,0),1), \sqrt{x^2+y^2}\leq z\leq \sqrt{1-x^2-y^2} \}. 
\]
L'ombre de $E$ est la boule unité de $\eR^2$. L'ensemble $\sqrt{x^2+y^2}\leq z$ est un cône posé sur sa pointe tandis que l'ensemble $z\leq\sqrt{ 1-x^2-y^2 }$ est la demi-sphère. L'ensemble $E$ contient les points entre les deux, voir la figure \ref{LabelFigCornetGlace}.
\newcommand{\CaptionFigCornetGlace}{Il faut voir ça en trois dimensions.}
\input{Fig_CornetGlace.pstricks}

\end{example}
Si la fonction $f$, à intégrer sur $E$, et ses sections sont intégrables  alors on peut réduire l'intégrale 
\begin{equation}
  \begin{aligned}
     \int_E  f(x,y,z)\, dV&=\int_A\left(\int_{u_1(x,y)}^{u_2(x,y)}f(x,y,z)\, dz \right) \, dV=\\
&=\int_A\left(F(x,y,u_2(x,y))-F(x,y,u_1(x,y))\right)\, dV,
  \end{aligned}
\end{equation}
où $F$ est une primitive de $f$ par rapport à la variable $z$, c'est à dire en considérant $x$ et $y$ comme des constantes. Il faut ensuite évaluer la partie qui reste comme dans la section précédente. Comme le calcul des aires  dans $\eR^2$, le calcul des volumes dans $\eR^3$ est fait par des intégrales. En fait le \defe{volume}{volume!d'une région solide} d'une région solide dans $\eR^3$ est sa mesure. 
\begin{definition}
   La mesure d'une région de  $\eR^3$ est l'intégrale de sa fonction caractéristique. 
\end{definition}
Soit $E$ une région solide du premier type, nous pouvons évaluer son volume par l'intégrale
\[
\int_A\left(u_2(x,y)-u_1(x,y)\right)\, dV.
\]  
Parfois c'est plus intéressant de calculer le volume avec la formule de réduction contraire : l'intégrale double d'abord et puis l'intégrale simple par rapport à $z$. On parle alors de calcul de volume «par tranche».

\begin{example}
On veut calculer le volume de la boule de rayon $a$, centrée à l'origine $B=\{(x,y,z)\in\eR^3\,\vert\, x^2+y^2+z^2\leq a^2 \}$. On peut décrire $B$ par
\[
  B=\left\{(x,y,z)\in\eR^3\,\vert\, (x,y)\in D_a, -\sqrt{a^2-x^2-y^2}\leq z\leq \sqrt{a^2-x^2-y^2}  \right\},
\]
où $D_a$ est le disque de rayon $a$ centré en $(0,0)$, donc le volume $B$ sera
\[
2 \int_{D_a}\sqrt{a^2-x^2-y^2} dV.
\] 
Cet intégrale est un peu ennuyeuse à calculer. On peut simplifier le calcul en observant que pour $\bar z$ fixé dans l'intervalle $[-a,a]$ la section de la boule au niveau $\bar z$ est un disque de rayon $\sqrt{a^2-z^2}$. L'aire d'un tel disque est  $\pi (a^2+z^2)$. Si on réduit l'intégrale de volume de la façon
\[
\int_{B} 1\, dV=\int_{-a}^{a}  \sqrt{a^2-z^2}\, dz,
\] 
on obtient tout de suite la valeur cherchée : le volume de $B$ est $4/3 \pi a^3$.   
\end{example}
\begin{example}
	On calcul l'intégrale de $f(x,y,z)=z$ sur la pyramide $P$ bornée par le plans $x=0$, $y=0$, $x+y+z=1$, $x+y+z/2=1$. On remarque tout de suite que le plans $x+y+z=1$, $x+y+z/2=1$ se coupent en la droite $x+y=1$, $z=0$ (on se souvient qu'\emph{une} droite dans $\eR^3$, c'est \emph{deux} équations). Cela veut dire que la projection de $P$ sur le plan $x$-$y$ est le  triangle $T$ borné par les droites $x=z=0$, $y=z=0$ et $x+y=1$, $z=0$.  
On  décrit donc $P$ par
\[
P=\{(x,y,z)\in\eR^3\,\vert\, (x,y)\in T, \, 1-2x-2y\leq z\leq 1-x-y\}
\] 
et $T$ par 
\[
T=\{(x,y)\in\eR^2\,\vert\, 0\leq x\leq 1,\,  0\leq y\leq 1-x\},
\]
donc l'intégrale de $f$ sur $P$ est 
\[
\int_pf(x,y,z)\, dV= \int_{0}^{1}\int_{0}^{1-x}\int_{1-2x-2y}^{1-x-y}z \,dz\,dy\,dx=-\frac{1}{ 24 }.
\]
Notez que lorsque $x$ et $y$ sont entre $0$ et $1$, nous avons bien $1-2x-2y<1-x-y$, d'où le fait que nous mettons $1-2x-2y$ dans la borne inférieure de l'intégrale.
\end{example}

De façon analogue on définit les régions solides du deuxième et du troisième type.  

%---------------------------------------------------------------------------------------------------------------------------
					\subsection[Fonctions et ensembles non bornés]{Intégrales de fonctions non bornées sur des ensembles non bornés}
%---------------------------------------------------------------------------------------------------------------------------

Soit $f\colon \eR^n\to \overline{ \eR }$, une fonction positive. On dit qu'elle est \defe{intégrable}{intégrable!fonction positive} sur $E\subset\eR^n$ si
\begin{enumerate}
    \item $\forall r>0$, la fonction $f_r(x)=f(x)\mtu_{f<r}$ est intégrable sur $E_r$;
\item la limite $\lim_{r\to\infty}\int_{E_r}f_r$ est finie.
\end{enumerate}
Dans ce cas, on pose 
\begin{equation}
	\int_Ef=\lim_{r\to\infty}\int_{E_r}f_r.
\end{equation}

\begin{theorem}[Page I.38]		\label{ThoFnTestIntnnBorn}
Soit $E$ mesurable dans $\eR^n$ et $f\colon E\to \overline{ \eR }$. Si $f$ est mesurable et si il existe $g\colon E\to \overline{ \eR }$ intégrable sur $E$ telle que $| f(x) |\leq g(x)$ pour tout $x\in E$, alors $f$ est intégrable sur~$E$.

Réciproquement, si $f$ est intégrable sur $E$, alors $f$ est mesurable.
\end{theorem}

\begin{lemma}\label{LemTHBSEs}
    Si \( f\) est une fonction sur \( \mathopen[ a , \infty [\), alors nous avons la formule
    \begin{equation}
        \lim_{b\to \infty}\int_a^bf(x)dx=\int_a^{\infty}f(x)dx
    \end{equation}
    au sens où si un des deux membres existe, alors l'autre existe et est égal.
\end{lemma}

\begin{proof}
    Supposons que le membre de gauche existe. Cela signifie que la fonction
    \begin{equation}
        \psi(x)=\int_a^xf
    \end{equation}
    est bornée. Soit \( M\), un majorant. Pour toute fonction simple \( \varphi\) dominant \( f\), on a que \( \int\varphi\leq M\), donc l'ensemble sur lequel on prend le supremum pour calculer \( \int_a^{\infty}f\) est majoré par \( M\) et possède donc un supremum. Nous avons donc
    \begin{equation}
        \int_a^{\infty}f\leq\lim_{b\to\infty}\int_a^bf.
    \end{equation}
\end{proof}
